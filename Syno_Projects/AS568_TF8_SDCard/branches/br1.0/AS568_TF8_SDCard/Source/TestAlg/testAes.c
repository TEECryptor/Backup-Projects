#include "SY03.h"
 
//----test AES 128 bits ECB mode ----
void TestAes128ECB(void)
{
	UINT8 in[32],out[32],dec[32];
	
	UINT8 pwd[16];
	UINT32 i;
	
	UINT8 OKRes[32]={0x0A,0x94,0x0B,0xB5,0x41,0x6E,0xF0,0x45,0xF1,0xC3,0x94,0x58,0xC6,0x53,0xEA,0x5A,
		             0x07,0xFE,0xEF,0x74,0xE1,0xD5,0x03,0x6E,0x90,0x0E,0xEE,0x11,0x8E,0x94,0x92,0x93};
	
	for(i=0;i<32;i++)
		in[i]=i;
	
	for(i=0;i<16;i++)
		pwd[i]=i;
 
	AES_Init(pwd,16);
	
	if(AES_Run(AES_ENCRYPT,AES128_ECB,in,out,32,NULL)!=RT_OK)
	{
		print("AES 128 ECB encry fail!\n");
		return;
	}
	
	if(memcmp(out,OKRes,32)!=0)
	{
		print("AES 128 ECB encry fail!\n");
		return;
	}
	
	if(AES_Run(AES_DECRYPT,AES128_ECB,out,dec,32,NULL)!=RT_OK)
	{
		print("AES 128 ECB decry fail!\n");
		return;
	}
	
	if(memcmp(dec,in,32)!=0)
	{
		print("AES 128 ECB decry fail!\n");
		return;
	}
	
	print("AES 128 ECB OK!\n");
	
	i=0;
	
}

//----test AES 192 bits ECB mode ----
void TestAes192ECB(void)
{
	UINT8 in[32],out[32],dec[32];
	
	UINT32 i;
	UINT8 pwd[24];
	
	UINT8 OKRes[32]={0xCF,0x3A,0x06,0xC3,0x28,0x37,0x52,0xAE,0x55,0xC4,0x2B,0x3E,
                     0xB4,0xDB,0x8B,0x73,0x04,0xB2,0xFC,0xEF,0xEF,0x67,0xDE,0xB4,
                     0x5A,0x7F,0x59,0x1B,0x34,0x94,0xE8,0xDB};
	
	for(i=0;i<32;i++)
		in[i]=i;
	for(i=0;i<24;i++)
		pwd[i]=i+1;
	
	AES_Init(pwd,24);
	
	if(AES_Run(AES_ENCRYPT,AES192_ECB,in,out,32,NULL)!=RT_OK)
	{
		print("AES 192 ECB decry fail!\n");
		return;
	}
	
	if(memcmp(out,OKRes,32)!=0)
	{
		print("AES 192 ECB encry fail!\n");
		return;
	}
	
	if(AES_Run(AES_DECRYPT,AES192_ECB,out,dec,32,NULL)!=RT_OK)
	{
		print("AES 192 ECB decry fail!\n");
		return;
	}
	if(memcmp(dec,in,32)!=0)
	{
		print("AES 192 ECB decry fail!\n");
		return;
	}
	i=0;
	print("AES 192 ECB OK!\n");
	
}

//----test AES 256 bits ECB mode ----
void TestAes256ECB(void)
{
	UINT8 in[32]={0x80}; 
	UINT8 out[32]={0};
	UINT8 result[32]={0};  
	UINT8 OKRes[32]={0xDD,0xC6,0xBF,0x79,0x0C,0x15,0x76,0x0D,0x8D,0x9A,
                     0xEB,0x6F,0x9A,0x75,0xFD,0x4E,0xDC,0x95,0xC0,0x78,
                     0xA2,0x40,0x89,0x89,0xAD,0x48,0xA2,0x14,0x92,0x84,
                     0x20,0x87}; 
	UINT8 pwd[32]={0x00};
	
	AES_Init(pwd,32); 
	
	if(AES_Run(AES_ENCRYPT,AES256_ECB,in,out,32,NULL)!=RT_OK)
	{
		print("AES 256 ECB decry fail!\n");
		return;
	}
	if(memcmp(out,OKRes,32)!=0)
	{
		print("AES 256 ECB encry fail!\n");
		return;
	}
	if(AES_Run(AES_DECRYPT,AES256_ECB,out,result,32,NULL)!=RT_OK)
	{
		print("AES 256 ECB decry fail!\n");
		return;
	}
	if(memcmp(result,in,32)!=0)
	{
		print("AES 256 ECB decry fail!\n");
		return;
	}
	print("AES 256 ECB OK!\n");
 
	
}

//----test AES 128 bits CBC mode ----
void TestAes128CBC(void)
{
	UINT8 in[32],out[32],dec[32]; 
	UINT8 iv[16],pIV[16];
	UINT32 i; 
	UINT8 OKRes[32]={0xF4,0xB7,0x47,0x24,0x81,0x6D,0xE4,0x43,0x54,0x97,
                    0xD0,0xEC,0xBA,0x7C,0x54,0xDB,0x01,0x62,0xFA,0x36,
                    0x56,0x55,0xB2,0x5C,0x18,0x57,0x59,0x5C,0x5B,0x64,
                    0xB2,0xF7};
	
	UINT8 pwd[16];
	
	for(i=0;i<32;i++)
		in[i]=i;
	
	memset(iv,0x55,16);
	memset(pwd,0x77,16);
	
	AES_Init(pwd,16);
	memcpy(pIV,iv,16);
	
	if(AES_Run(AES_ENCRYPT,AES128_CBC,in,out,32,pIV)!=RT_OK)
	{
		print("AES 128 CBC decry fail!\n");
		return;
	}
	if(memcmp(out,OKRes,32)!=0)
	{
		print("AES 128 CBC encry fail!\n");
		return;
	}
	memcpy(pIV,iv,16);
	
	if(AES_Run(AES_DECRYPT,AES128_CBC,out,dec,32,pIV)!=RT_OK)
	{
		print("AES 128 CBC decry fail!\n");
		return;
	}
	if(memcmp(dec,in,32)!=0)
	{
		print("AES 128 CBC decry fail!\n");
		return;
	}
	print("AES 128 CBC OK!\n");
	 
}

//----test AES 192 bits CBC mode ----
void TestAes192CBC(void)
{
	UINT8 in[32],out[32],dec[32];
	
	UINT8 iv[16],pIV[16];
	
	UINT32 i;
	UINT8 OKRes[32]={0x1F,0x98,0x88,0x8E,0x27,0xDB,0x81,0x8B,0x8E,0xF1,
                    0x74,0xCD,0xD6,0xA0,0xF5,0xCD,0xE6,0xA6,0x63,0x39,
                    0x90,0x38,0x44,0x9E,0xFF,0xCE,0xAE,0xA1,0x87,0xF6,
                    0x2A,0xA0};
	UINT8 pwd[24];
	
	for(i=0;i<32;i++)
		in[i]=i;
	
	memset(iv,0x55,16);
	memset(pwd,0x77,24);
	
	AES_Init(pwd,24);
	
	memcpy(pIV,iv,16);
	
	if(AES_Run(AES_ENCRYPT,AES192_CBC,in,out,32,pIV)!=RT_OK)
	{
        print("AES 192 CBC decry fail!\n");
		return;
	}
	
    if(memcmp(out,OKRes,32)!=0)
	{
		print("AES 128 CBC encry fail!\n");
		return;
	}
	memcpy(pIV,iv,16);
	if(AES_Run(AES_DECRYPT,AES192_CBC,out,dec,32,pIV)!=RT_OK)
	{
       	print("AES 192 CBC decry fail!\n");
		return;
	}
    
    if(memcmp(dec,in,32)!=0)
	{
		print("AES 128 CBC decry fail!\n");
		return;
	}
	print("AES 192 CBC OK!\n");
	
}
	
//----test AES 256 bits CBC mode ---- 		
void TestAes256CBC(void)
{
	UINT8 in[64]={0x13,0xdf,0xc8,0xd2,0x55,0x1c,0x42,0x0d,0xe6,0xdb,0xf2,0x7b,
		0x63,0x52,0x00,0x34,0xce,0x8b,0x22,0xa5,0x34,0x72,0x63,0x3f,0x8d,0x2d,0x24,
		0x70,0xe4,0xab,0x60,0xd3,0xb8,0x80,0x34,0xa4,0xa1,0xf0,0x9e,0x76,0x37,0x49,0x85,0x28,0x2f,0x77,0xf9,0x15};
	
	UINT8 out[64]={0};
	UINT8 result[64]={0};
	UINT8 iv[16]={0xd6,0xf9,0x3e,0x57,0x83,0x08,0x09,0x47,0xfe,0xf8,0x58,0x3d,0xb2,0x57,0x11,0xd5},pIV[16];
	 
	UINT8 OKRes[64]={0x73,0xF8,0x12,0xFE,0x10,0xF4,0x7A,0xD4,0x9F,0x85,0xE8,0x11,0xE9,0x10,
                     0x6D,0xBE,0x4A,0xF2,0x44,0x1B,0xF0,0xF2,0xBF,0x11,0x75,0x23,0x52,0x72,
                     0x2D,0x46,0x4A,0xA8,0x4F,0x60,0xDD,0xDB,0x60,0x83,0xE1,0x95,0x62,0xC5,
                     0xFE,0x8A,0xD4,0x00,0x51,0x93,0x05,0x5E,0x15,0x3E,0xBE,0x03,0x32,0x8C,
                     0x25,0x42,0x11,0x69,0x31,0xA9,0x9E,0x56};
	
	UINT8 pwd[32]={0xe3,0xec,0x52,0x8e,0xc3,0xd8,0x29,0x78,0xf9,0x9d,0xea,0x43,0xa6,0xa3,0xee,0x38,
		0x07,0x08,0x68,0x0d,0x02,0xe8,0x98,0x51,0xfe,0xdc,0x41,0x0a,0xf8,0xc0,0x5c,0x9c}; 

	AES_Init(pwd,32); 
	memcpy(pIV,iv,16);

	if(AES_Run(AES_ENCRYPT,AES256_CBC,in,out,64,pIV)!=RT_OK)
	{
		print("AES 256 CBC decry fail!\n");	
		return;
	}
	
	if(memcmp(out,OKRes,64)!=0)
	{
		print("AES 128 CBC encry fail!\n");
		return;
	}
	
	memcpy(pIV,iv,16);
	if(AES_Run(AES_DECRYPT,AES256_CBC,out,result,64,pIV)!=RT_OK)
	{
		print("AES 256 CBC decry fail!\n");
		return;
	}
	if(memcmp(result,in,64)!=0)
	{
		print("AES 128 CBC decry fail!\n");
		return;
	}
	print("AES 256 CBC OK!\n");		 
	
}
