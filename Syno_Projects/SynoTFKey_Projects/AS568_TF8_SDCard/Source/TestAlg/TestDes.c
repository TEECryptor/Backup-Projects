#include "SY03.h"	
//----test DES CBC mode ----
void TestDesCBC(void)
{
	UINT8 in[32]={0x80};
	
	UINT8 out[32]={0};
	UINT8 result[32]={0};
	UINT8 iv[8]={0},pIV[8];
 
	UINT8 OKRes[32]={0x95,0xF8,0xA5,0xE5,0xDD,0x31,0xD9,0x00,0x80,
                     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x95,0xF8,
                     0xA5,0xE5,0xDD,0x31,0xD9,0x00,0x80,0x00,0x00,
                     0x00,0x00,0x00,0x00,0x00};
	
	UINT8 pwd[8]={0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01};
	
	iv[0]=0;
	
	
	DES_Init(pwd,8);
	
	memcpy(pIV,iv,8);
	if(DES_Run(DES_ENCRYPT,DES_CBC,in,out,32,pIV)!=RT_OK)
	{
        print("DES CBC encry fail!\n");
		return;
	}
	if(memcmp(out,OKRes,32)!=0)
	{
		print("Des CBC encry fail!\n");
		return;
	}
	memcpy(pIV,iv,8);
	if(DES_Run(DES_DECRYPT,DES_CBC,out,result,32,pIV)!=RT_OK)
	{
        print("DES CBC decry fail!\n");
		return;
	}
	if(memcmp(result,in,32)!=0)
	{
		print("Des CBC decry fail!\n");
		return;
	}
	print("DES CBC OK!\n");
}
//----test DES ECB mode ----  	
void TestDesECB(void)
{  
	UINT8 in[32]={0x40};
	
	UINT8 out[32]={0};
	UINT8 result[32]={0};
 
 
	UINT8 OKRes[32]={0xDD,0x7F,0x12,0x1C,0xA5,0x01,0x56,0x19,0x8C,0xA6,
                    0x4D,0xE9,0xC1,0xB1,0x23,0xA7,0x8C,0xA6,0x4D,0xE9,
                    0xC1,0xB1,0x23,0xA7,0x8C,0xA6,0x4D,0xE9,0xC1,0xB1,
                    0x23,0xA7};
	
	UINT8 pwd[8]={0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01};
 
 

	DES_Init(pwd,8);
	  
	if(DES_Run(DES_ENCRYPT,DES_ECB,in,out,32,NULL)!=RT_OK)// dd7f121ca5015619
	{
        print("DES ECB encry fail!\n");
		return;
	}
 
	if(memcmp(out,OKRes,32)!=0)
	{
		print("Des ECB encry fail!\n");
		return;
	}
	if(DES_Run(DES_DECRYPT,DES_ECB,out,result,32,NULL)!=RT_OK)
	{
        print("DES ECB decry fail!\n");
		return;
	}
	if(memcmp(result,in,32)!=0)
	{
		print("Des ECB decry fail!\n");
		return;
	}
	print("DES ECB OK!\n");
    
}

//----test 3DES CBC mode ----	
void Test3DesCBC(void)
{
	
	UINT8 in[32]={0x6e,0x49,0x38,0x17,0xe4,0xef,0x64,0x77,
		0x59,0x12,0xbc,0x6f,0xaf,0x95,0xe4,0x26,0x42,0xf7,0xaf,0x2f,0x27,0x85,0x87,0x5d};
	
    UINT8 OKRes[32]={0x27,0x2B,0xE1,0x6E,0x23,0x1F,0x59,0x97,0x67,0x5D,0x41,
                    0xA0,0x21,0xC5,0xFA,0x71,0xCF,0xF3,0xC6,0x81,0xC3,0xFE,
                    0x75,0x3C,0xA7,0x14,0x9F,0x03,0x56,0x49,0xA6,0x25};
	
	UINT8 out[32]={0};
	UINT8 result[32]={0};
	UINT8 iv[8]={0xfb,0x99,0x7d,0x45,0x83,0x37,0x43,0x55},pIV[8];
	
 
	UINT8 pwd[25]={0xb0,0x6d,0xfe,0x62,0x9e,0x9e,0xb0,0xb9,0xb0,0x6d,0xfe,0x62,0x9e,0x9e,0xb0,0xb9,0xb0,0x6d,0xfe,0x62,0x9e,0x9e,0xb0,0xb9};

	DES_Init(pwd,24);
	
	memcpy(pIV,iv,8);
	if(DES_Run(DES_ENCRYPT,DES3_CBC,in,out,32,pIV)!=RT_OK)
	{
        print("3DES CBC encry fail!\n");
		return;
	}
		if(memcmp(out,OKRes,32)!=0)
	{
		print("3DES CBC  encry fail!\n");
		return;
	}
	
	memcpy(pIV,iv,8);
	if(DES_Run(DES_DECRYPT,DES3_CBC,out,result,32,pIV)!=RT_OK)
	{
         print("3DES CBC  decry fail!\n");
		return;
	}
	
	if(memcmp(result,in,32)!=0)
	{
		print("3DES CBC  decry fail!\n");
		return;
	}
	print("3DES CBC  OK!\n");
}
//----test 3DES ECB mode ----	
void Test3DesECB(void)
{
	UINT8 in[32]={0x9a,0x60,0xc2,0x2d,0x25,0xc6,0xb8,0x11,0x6e,0x4f,0x2f,0xb4,0xa9,0x6f,0x9c,0x4a};
 
	UINT8 OKRes[32]={0xCA,0xD7,0xAB,0xE0,0x10,0x44,0xCC,0x54,0x22,0x05,
                     0x43,0x6A,0xF9,0x75,0xE5,0x70,0x60,0xC0,0xA7,0xF0,
                     0x55,0xE3,0x06,0x93,0x60,0xC0,0xA7,0xF0,0x55,0xE3,0x06,0x93};
	
	UINT8 out[32]={0};
	UINT8 result[32]={0};
 
 
	UINT8 pwd[25]={0x15,0x3e,0xf2,0xea,0xbf,0x45,0x1a,0x08,0x15,0x3e,0xf2,0xea,0xbf,0x45,0x1a,0x08,0x15,0x3e,0xf2,0xea,0xbf,0x45,0x1a,0x08};
	
	DES_Init(pwd,24);
	
	
	if(DES_Run(DES_ENCRYPT,DES3_ECB,in,out,32,NULL)!=RT_OK)
	{
        print("3DES ECB encry fail!\n");
		return ;
	}
	if(memcmp(out,OKRes,32)!=0)
	{
		print("3Des ECB encry fail!\n");
		return;
	}
	
	if(DES_Run(DES_DECRYPT,DES3_ECB,out,result,32,NULL)!=RT_OK)
	{
         print("3DES ECB decry fail!\n");
		return ;
	}
	
    if(memcmp(result,in,32)!=0)
	{
		print("3Des ECB decry fail!\n");
		return ;
	}
	print("3DES ECB OK!\n");
}
