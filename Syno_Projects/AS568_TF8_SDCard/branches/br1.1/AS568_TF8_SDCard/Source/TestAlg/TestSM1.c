#include "SY03.h"  

//----test SM1 ECB mode ----
void TestSM1ECB(void)
{ 	
	const UINT8 EK[16] = {0x40,0xBB,0x12,0xDD,0x6A,0x82,0x73,0x86,0x7F,0x35,0x29,0xD3,0x54,0xB4,0xA0,0x26}; 
	const UINT8 AK[16] = {0x0C,0x90,0xE1,0x5A,0x4F,0x92,0x36,0xB2,0x12,0x34,0x56,0x78,0x12,0x34,0x56,0x78}; 
    const UINT8 DATA[16] = {0xEE,0x4D,0x7D,0x19,0x90,0x0D,0x7E,0xFA,0x4E,0xB2,0x04,0x0F,0x39,0x37,0x77,0xDA};	 
    const UINT8 OKRes[16]={0x31,0x11,0x31,0xde,0x3c,0x51,0xdd,0x69,0x38,0x6a,0x74,0xf4,0x4c,0x7a,0xfd,0xb4}; 
	UINT8 RES[16];
	UINT8 DecData[16];

	SM1_Init((UINT8*)EK,(UINT8*)AK);
	SM1_Run(SM1_ENCRYPT,SM1_ECB,(UINT8*)DATA,RES,16,NULL); 

	 if(memcmp(RES,OKRes,16)!=0)
	 {
	 	 print("sm1 ecb encry fail!\n");
	 	 return;
	 }
	
	 SM1_Run(SM1_DECRYPT,SM1_ECB,RES,DecData,16,NULL);
	
	  if(memcmp(DATA,DecData,16)!=0)
	 {
	 	 print("sm1 ecb decry fail!\n");
	 	 return;
	 }
	 print("sm1 ecb ok!\n"); 
}
//----test SM1 CBC mode ----
void TestSM1CBC(void)
{ 
	const UINT8 EK[16] = {0x40,0xbb,0x12,0xdd,0x6a,0x82,0x73,0x86,0x7f,0x35,0x29,0xd3,0x54,0xb4,0xa0,0x26};
	const UINT8 AK[16] = {0xa2,0x91,0xb3,0xeb,0xa4,0xed,0x22,0x5f,0x1c,0xea,0xa6,0x07,0x62,0x8f,0xb2,0x36}; 
	const UINT8 DATA[32]= {0xff,0xee,0xdd,0xcc,0xbb,0xaa,0x99,0x88,0x77,0x66,0x55,0x44,0x33,0x22,0x11,0x00,
                     0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xaa,0xbb,0xcc,0xdd,0xee,0xff}; 
    const UINT8 OKRes[32]={0xf6,0x07,0x27,0xc1,0x1e,0xa7,0x18,0x9f,0xd4,0x5a,0x6a,0x9d,0x10,0x79,0xaa,0x08,
                 0xcf,0x6f,0x4c,0xc9,0x42,0x69,0xec,0xc0,0x15,0x55,0x4e,0x6a,0xa4,0xc9,0x4c,0x4b};   
	 UINT8 IV[16] = {0xe8,0x3d,0x17,0x15,0xac,0xf3,0x48,0x63,0xac,0xeb,0x93,0xe0,0xe5,0xab,0x8b,0x90};

     UINT8 pIV[16];	 
	 UINT8 Out[32]; 
  	 UINT8 DecData[32];

	 SM1_Init((UINT8*)EK,(UINT8*)AK);
	 memcpy(pIV,IV,16);

	 memcpy(DecData,DATA,32);
	 SM1_Run(SM1_ENCRYPT,SM1_CBC,DecData,Out,32,pIV);
 
	  if(memcmp(Out,OKRes,32)!=0)
	 {
	 	 print("sm1 cbc encry fail!\n");
	 	 return;
	 }	
	
     memcpy(pIV,IV,16);
	 SM1_Run(SM1_DECRYPT,SM1_CBC,Out,DecData,32,pIV);
	 if(memcmp(DATA,DecData,32)!=0)
	 {
	 	 print("sm1 cbc decry fail!\n");
	 	 return;
	 }
	 print("sm1 cbc ok!\n");
	 
}


 
